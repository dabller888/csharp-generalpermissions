<#@ template language="C#" debug="false" hostspecific="true"#>
<#@ output extension=".cs"#>
<#@ assembly name="System.Data" #>
<#@ assembly name="System.Data.DataSetExtensions" #>
<#@ assembly name="System.xml" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ import namespace="System.Data.SqlClient" #>
<#@ import namespace="System.Data" #>
<#@ assembly name="System.Core" #>
<#@ import namespace="System.Linq" #>
<#@include file="$(ProjectDir)\DbHelper.ttinclude"#> 
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using QY.Stage.Model.PocoModel;
using QY.Stage.IBLL;
using QY.Stage.BLL;
namespace QY.Stage.BLL {
<#
	SqlConnection conn = new SqlConnection(config.ConnectionString);
    conn.Open();    
    string selectQuery ="SET FMTONLY ON; select * from @tableName; SET FMTONLY OFF;";
    SqlCommand command = new SqlCommand(selectQuery,conn);
    SqlDataAdapter ad = new SqlDataAdapter(command);
    System.Data.DataSet ds = new DataSet();
    System.Data.DataTable schema = conn.GetSchema("Tables");
    foreach(System.Data.DataRow row in schema.Rows)
    {
        string tb_name= row["TABLE_NAME"].ToString();
		PushIndent("    ");
		WriteLine("public partial class "+tb_name+"Service : BaseService<"+tb_name+">, I"+tb_name+"Service {");
		PushIndent("	");
		WriteLine("public override void SetCurrentRepository() {");
		PushIndent("	");
		WriteLine("CurrentRepository = _dbSession."+tb_name+"Repository;");		
		PopIndent();
		WriteLine("}");
		PopIndent();
		WriteLine("}");
		PopIndent();
    }
#>
}